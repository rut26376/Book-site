<div class="admin-container">
  <!-- Header -->
  <div class="admin-header">
    <h1>ğŸ”§ ×××©×§ × ×™×”×•×œ</h1>
    <div class="header-info">
      <span>×©×œ×•×, {{ currentUser?.fullName }}</span>
      <button class="btn-back" (click)="goHome()" title="×—×–×•×¨ ×œ×¢××•×“ ×”×‘×™×ª">
        â† ×—×–×•×¨ ×œ×¢××•×“ ×”×‘×™×ª
      </button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="admin-tabs">
    <button 
      [class.active]="activeTab === 'books'"
      (click)="activeTab = 'books'"
      class="tab-btn">
      ğŸ“š × ×™×”×•×œ ×¡×¤×¨×™×
    </button>
    <button 
      [class.active]="activeTab === 'orders'"
      (click)="activeTab = 'orders'"
      class="tab-btn">
      ğŸ“¦ ×”×–×× ×•×ª
    </button>
  </div>

  <!-- Books Tab -->
  <div *ngIf="activeTab === 'books'" class="tab-content">
    <!-- Add New Book Form -->
    <div class="add-book-section">
      <h2>×”×•×¡×£ ×¡×¤×¨ ×—×“×©</h2>
      <div class="form-grid">
        <input 
          [(ngModel)]="newBook.bookName" 
          placeholder="×©× ×”×¡×¤×¨"
          class="form-input">
        
        <input 
          [(ngModel)]="newBook.author" 
          placeholder="××—×‘×¨"
          class="form-input">
        
        <input 
          [(ngModel)]="newBook.price" 
          type="number" 
          placeholder="××—×™×¨"
          class="form-input">
        
        <input 
          [(ngModel)]="newBook.size" 
          placeholder="×’×•×“×œ (×›×’×•×Ÿ: 400 ×¢××•×“×™×)"
          class="form-input">
        
        <!-- File Upload for Image -->
        <div class="file-upload-wrapper">
          <label for="bookImage" class="file-upload-label">
            ğŸ“· ×‘×—×¨ ×ª××•× ×” ×œ×¡×¤×¨
          </label>
          <input 
            #fileInput
            type="file" 
            id="bookImage"
            accept="image/*"
            (change)="onImageSelected($event)"
            class="file-input">
          <div class="file-preview" *ngIf="newBook.picture">
            <img [src]="uploadService_public.getImageUrl(newBook.picture)" alt="Preview" class="preview-img">
            <p class="file-name">{{ newBook.picture }}</p>
          </div>
        </div>
        
        <textarea 
          [(ngModel)]="newBook.description" 
          placeholder="×ª×™××•×¨ ×”×¡×¤×¨"
          class="form-textarea"></textarea>
      </div>

      <!-- Categories Selection -->
      <div class="categories-section">
        <h3>×‘×—×¨ ×§×˜×’×•×¨×™×•×ª:</h3>
        
        <!-- Main Category -->
        <div class="form-group">
          <label>×§×˜×’×•×¨×™×” ×¨××©×™×ª:</label>
          <select 
            [(ngModel)]="selectedMainCategory" 
            (change)="onMainCategoryChange()"
            class="form-select">
            <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”...</option>
            <option *ngFor="let cat of categories" [value]="cat.main">
              {{ cat.main }}
            </option>
          </select>
        </div>

        <!-- Sub Categories -->
        <div class="form-group" *ngIf="selectedMainCategory">
          <label>×§×˜×’×•×¨×™×•×ª ××©× ×™×•×ª (×‘×—×¨ ××¨×•×‘):</label>
          <div class="sub-categories-list">
            <button 
              *ngFor="let sub of availableSubCategories"
              [class.active]="selectedSubCategories.includes(sub)"
              (click)="addSubCategory(sub)"
              type="button"
              class="category-btn-select">
              {{ sub }}
            </button>
          </div>
        </div>

        <!-- Selected Categories Display -->
        <div class="selected-categories" *ngIf="newBook.category.length > 0">
          <h4>×§×˜×’×•×¨×™×•×ª ×©× ×‘×—×¨×•:</h4>
          <div class="category-chips">
            <div 
              *ngFor="let cat of newBook.category" 
              class="category-chip">
              {{ cat.main }} / {{ cat.sub }}
              <button 
                (click)="removeSubCategory(cat.sub)"
                type="button"
                class="chip-remove">Ã—</button>
            </div>
          </div>
        </div>
      </div>
      
      <button (click)="addNewBook()" class="btn-add">
        â• ×”×•×¡×£ ×¡×¤×¨
      </button>
    </div>

    <!-- Books List Component -->
    <app-books></app-books>
  </div>

  <!-- Orders Tab -->
  <div *ngIf="activeTab === 'orders'" class="tab-content">
    <h2>×”×–×× ×•×ª ({{ orders.length }})</h2>
    <div class="orders-list">
      <p *ngIf="orders.length === 0" class="no-data">××™×Ÿ ×”×–×× ×•×ª ×¢×“×™×™×Ÿ</p>
      <div *ngFor="let order of orders" class="order-item">
        <div class="order-header">
          <span class="order-id">#{{ order.id }}</span>
          <span class="order-date">{{ order.date | date:'dd/MM/yyyy' }}</span>
          <span class="order-status" [class]="'status-' + order.status">{{ order.status }}</span>
        </div>
        <div class="order-details">
          <p><strong>×œ×§×•×—:</strong> {{ order.fullName }}</p>
          <p><strong>××™××™×™×œ:</strong> {{ order.email }}</p>
          <p><strong>×˜×œ×¤×•×Ÿ:</strong> {{ order.phone }}</p>
          <p><strong>×›×ª×•×‘×ª:</strong> {{ order.street }} {{ order.houseNumber }}, {{ order.city }}</p>
          <p><strong>×¡×›×•× ×›×•×œ×œ:</strong> â‚ª{{ order.totalAmount }}</p>
        </div>
        <div class="order-items">
          <h4>×¤×¨×™×˜×™× ×‘×”×–×× ×”:</h4>
          <ul>
            <li *ngFor="let item of order.items">
              {{ item.bookName }} x{{ item.quantity }} = â‚ª{{ item.price * item.quantity }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
