<div class="menu-container">
  <!-- Header -->
  <header class="menu-header">
    <div class="header-left">
      <div class="logo" (click)="callBranch(storePhone)">{{ storePhone }}</div>
      <button class="cart-btn" (click)="goToCart()" title="×¡×œ ×§× ×™×•×ª">
        <img src="/assets/general/cart.png" alt="Basket" class="cart-icon">
        <div class="cart-badge" *ngIf="cartItemCount > 0">{{ cartItemCount }}</div>
      </button>
      <button class="cart-btn" (click)="goToBranches()" title="×¡× ×™×¤×™×">
        <img src="/assets/general/store.png" alt="Stores" class="cart-icon">
      </button>
      <!-- User Profile / Auth Buttons -->
      <div class="auth-section">
        <div *ngIf="!currentUser" class="auth-buttons">
          <button class="auth-btn login-btn" (click)="openLoginModal()">×”×ª×—×‘×¨×•×ª</button>
          <button class="auth-btn register-btn" (click)="openRegisterModal()">×”×¨×©××”</button>
        </div>
        <div *ngIf="currentUser" class="user-profile-wrapper">
          <button class="cart-btn" (click)="toggleUserDropdown()" title="×¤×¨×˜×™ ×—×©×‘×•×Ÿ">
            <img src="/assets/general/profile-user.png" alt="Profile" class="cart-icon">
          </button>
          <div class="user-dropdown-menu" *ngIf="showUserDropdown">
            <div class="dropdown-user-header">
              <span class="dropdown-user-name">{{ currentUser.fullName }}</span>
              <span class="dropdown-user-email">{{ currentUser.email }}</span>
            </div>
            <div class="dropdown-divider"></div>
            <button class="dropdown-user-item" (click)="goToEditProfile()">
              ×¢×¨×™×›×ª ×¤×¨×˜×™×
            </button>
            <button *ngIf="currentUser.role === 'admin'" class="dropdown-user-item admin-item" (click)="goToAdmin()">
              ğŸ”§ ×××©×§ × ×™×”×•×œ
            </button>
            <button class="dropdown-user-item logout-item" (click)="logoutUser()">
              ×”×ª× ×ª×§×•×ª
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="search-box">
      <input type="text" placeholder="×—×™×¤×•×©..." class="search-input" [(ngModel)]="searchQuery"
        (ngModelChange)="search(searchQuery)">
    </div>
    <div class="header-right">
      <img src="../../../public/logo.png" alt="Logo" class="logo-image">
    </div>
  </header>

  <!-- ×ª×™×‘×ª ×—×™×¤×•×© ×¢× Dropdown ×©×œ ×ª×•×¦××•×ª -->
  <div class="search-results-dropdown" *ngIf="searchBooks.length > 0">
    <div class="search-results-list">
      <div class="search-result-item" *ngFor="let book of searchBooks" (click)="viewBook(book)">
        <div class="result-image">
          <img src="/assets/book-img/{{ book.picture }}" [alt]="book.bookName" />
        </div>
        <div class="result-info">
          <h4 class="result-name">{{ book.bookName }}</h4>
          <p class="result-author">{{ book.author }}</p>
          <span class="result-price">â‚ª {{ book.price }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Categories Navigation -->
  <nav class="categories">
    <button class="category-btn" *ngFor="let category of categories" (click)="filterByCategory(category.main)">
      <img [src]="category.icon" [alt]="category.main" class="category-icon" />
      <span class="category-name">{{ category.main }}</span>
    </button>
  </nav>
</div>

<!-- Auth Modal -->
<app-auth-modal></app-auth-modal>

